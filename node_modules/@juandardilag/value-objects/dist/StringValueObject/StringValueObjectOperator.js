"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StringValueObjectOperator = void 0;
const tslib_1 = require("tslib");
const StringValueObject_1 = require("./StringValueObject");
const node_forge_1 = require("node-forge");
class StringValueObjectOperator {
    constructor(_key, _iv) {
        this._key = _key;
        this._iv = _iv;
    }
    add(a, b) {
        return new StringValueObject_1.StringValueObject(a.value + b.value);
    }
    encrypt(val) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            var cipherer = node_forge_1.cipher.createCipher("AES-CBC", this._key);
            cipherer.start({ iv: this._iv });
            cipherer.update(node_forge_1.util.createBuffer(node_forge_1.util.encodeUtf8(val)));
            cipherer.finish();
            return cipherer.output.toString();
        });
    }
    decrypt(val) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            var decipher = node_forge_1.cipher.createDecipher("AES-CBC", this._key);
            decipher.start({ iv: this._iv });
            decipher.update(node_forge_1.util.createBuffer(val));
            decipher.finish();
            return decipher.output.toString();
        });
    }
}
exports.StringValueObjectOperator = StringValueObjectOperator;
